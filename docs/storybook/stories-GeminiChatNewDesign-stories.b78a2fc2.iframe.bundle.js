"use strict";(self.webpackChunkreact_neuro=self.webpackChunkreact_neuro||[]).push([[32],{"./src/components/MaterialMarkdown.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>MaterialMarkdown});var react_markdown__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-markdown/lib/index.js"),_mui_material__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@mui/material/styles/useTheme.js"),_mui_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/material/Typography/Typography.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/Link/Link.js"),_mui_material__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@mui/material/List/List.js"),_mui_material__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@mui/material/ListItem/ListItem.js"),_mui_material__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@mui/material/Divider/Divider.js"),_mui_material__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@mui/material/Paper/Paper.js"),_mui_material__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@mui/material/Box/Box.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const MaterialMarkdown=_ref=>{let{content}=_ref;const theme=(0,_mui_material__WEBPACK_IMPORTED_MODULE_1__.A)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_markdown__WEBPACK_IMPORTED_MODULE_2__.oz,{components:{h1:_ref2=>{let{node,...props}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.A,{variant:"h3",gutterBottom:!0,...props})},h2:_ref3=>{let{node,...props}=_ref3;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.A,{variant:"h4",gutterBottom:!0,...props})},h3:_ref4=>{let{node,...props}=_ref4;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.A,{variant:"h5",gutterBottom:!0,...props})},p:_ref5=>{let{node,...props}=_ref5;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.A,{variant:"body1",paragraph:!0,sx:{m:0},...props})},a:_ref6=>{let{node,...props}=_ref6;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_4__.A,{color:"secondary",underline:"hover",target:"_blank",rel:"noopener",...props})},ul:_ref7=>{let{node,...props}=_ref7;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_5__.A,{dense:!0,sx:{pl:4},...props})},ol:_ref8=>{let{node,...props}=_ref8;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_5__.A,{component:"ol",dense:!0,sx:{pl:4},...props})},li:_ref9=>{let{node,...props}=_ref9;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_6__.Ay,{sx:{display:"list-item",listStyleType:"disc",p:0,pl:"4px"},...props})},hr:_ref10=>{let{node,...props}=_ref10;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.A,{sx:{my:2},...props})},blockquote:_ref11=>{let{node}=_ref11;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,{variant:"outlined",sx:{p:2,my:2,borderLeft:`4px solid ${theme.palette.divider}`,bgcolor:"background.default"}})},code:_ref12=>{let{node,...props}=_ref12;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_9__.A,{component:"span",sx:{fontFamily:"monospace",bgcolor:"action.hover",px:.5,borderRadius:1,whiteSpace:"pre-wrap",p:2,my:1,display:"block"},...props})},strong:_ref13=>{let{node,...props}=_ref13;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.A,{component:"span",fontWeight:"bold",...props})},em:_ref14=>{let{node,...props}=_ref14;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_3__.A,{component:"span",fontStyle:"italic",...props})}},children:content})};MaterialMarkdown.__docgenInfo={description:"",methods:[],displayName:"MaterialMarkdown",props:{content:{required:!0,tsType:{name:"string"},description:""}}}},"./src/hooks/useAgentKey.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>useAgentKey});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const useAgentKey=()=>{const[apiKey,setApiKey]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>{try{const savedData=localStorage.getItem("API_KEY");if(savedData){const parsedData=JSON.parse(savedData);if(parsedData.length>0)return parsedData}}catch(error){console.error("Error load from localStorage key API_KEY:",error)}return""}));(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{try{const valueToStore=JSON.stringify(apiKey);localStorage.setItem("API_KEY",valueToStore)}catch(error){console.error("Error saving to localStorage key API_KEY:",error)}}),[apiKey]);return{apiKey,setApiKey,deleteKey:()=>{localStorage.removeItem("API_KEY"),setApiKey("")}}}},"./src/hooks/useGoogleGenerativeAI.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>useGoogleGenerativeAI});var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@google/generative-ai/dist/index.mjs"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js");const useGoogleGenerativeAI=apiKey=>({googleGenerativeAI:(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.ij(apiKey)),[apiKey])})},"./src/interfaces/ChatHistoryInterfaces.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>ROLE_NAMES});const ROLE_NAMES={USER:"user",MODEL:"model"}},"./src/stories/GeminiChatNewDesign.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>GeminiChatNewDesign_stories});var emotion_element_f0de968e_browser_esm=__webpack_require__("./node_modules/@emotion/react/dist/emotion-element-f0de968e.browser.esm.js"),createTheme=__webpack_require__("./node_modules/@mui/material/styles/createTheme.js"),useMediaQuery=__webpack_require__("./node_modules/@mui/material/useMediaQuery/index.js"),CssBaseline=__webpack_require__("./node_modules/@mui/material/CssBaseline/CssBaseline.js"),GlobalStyles=__webpack_require__("./node_modules/@mui/material/GlobalStyles/GlobalStyles.js"),Container=__webpack_require__("./node_modules/@mui/material/Container/Container.js"),List=__webpack_require__("./node_modules/@mui/material/List/List.js"),ListItem=__webpack_require__("./node_modules/@mui/material/ListItem/ListItem.js"),Paper=__webpack_require__("./node_modules/@mui/material/Paper/Paper.js"),Box=__webpack_require__("./node_modules/@mui/material/Box/Box.js"),Button=__webpack_require__("./node_modules/@mui/material/Button/Button.js"),Dialog=__webpack_require__("./node_modules/@mui/material/Dialog/Dialog.js"),DialogContent=__webpack_require__("./node_modules/@mui/material/DialogContent/DialogContent.js"),DialogTitle=__webpack_require__("./node_modules/@mui/material/DialogTitle/DialogTitle.js"),IconButton=__webpack_require__("./node_modules/@mui/material/IconButton/IconButton.js"),Stack=__webpack_require__("./node_modules/@mui/material/Stack/Stack.js"),TextField=__webpack_require__("./node_modules/@mui/material/TextField/TextField.js"),Typography=__webpack_require__("./node_modules/@mui/material/Typography/Typography.js"),CircularProgress=__webpack_require__("./node_modules/@mui/material/CircularProgress/CircularProgress.js"),grey=__webpack_require__("./node_modules/@mui/material/colors/grey.js"),react=__webpack_require__("./node_modules/react/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),VpnKey=__webpack_require__("./node_modules/@mui/icons-material/esm/VpnKey.js"),Close=__webpack_require__("./node_modules/@mui/icons-material/esm/Close.js"),Send=__webpack_require__("./node_modules/@mui/icons-material/esm/Send.js"),ChatHistoryInterfaces=__webpack_require__("./src/interfaces/ChatHistoryInterfaces.ts"),useAgentKey=__webpack_require__("./src/hooks/useAgentKey.ts"),useGoogleGenerativeAI=__webpack_require__("./src/hooks/useGoogleGenerativeAI.ts"),MaterialMarkdown=__webpack_require__("./src/components/MaterialMarkdown.tsx"),Delete=__webpack_require__("./node_modules/@mui/icons-material/esm/Delete.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const ChatTextarea=styled_components_browser_esm.Ay.textarea`
  overflow: hidden;
  font-size: 16px;
  resize: none;
  width: 100%;
  display: block;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  outline: none;
  outline-style: none;
  border: none;
  margin: 0;
  padding: 0;
  min-height: 60px;
  background-color: transparent;
  color: white;
  &::placeholder {
    color: white;
  }
`,theme=(0,createTheme.A)({palette:{mode:"dark"}}),GeminiChatNewDesign=()=>{const{apiKey,setApiKey,deleteKey}=(0,useAgentKey.G)(),{googleGenerativeAI}=(0,useGoogleGenerativeAI.j)(apiKey),[openDialog,setOpenDialog]=(0,react.useState)(!1),[textareaValue,setTextareaValue]=(0,react.useState)(""),[loading,setLoading]=(0,react.useState)(!1),[error,setError]=(0,react.useState)(""),abortControllerRef=(0,react.useRef)(null),textareaRef=(0,react.useRef)(null),isMobile=(0,useMediaQuery.A)(theme.breakpoints.down("md")),chatHistoryEnd=(0,react.useRef)(null),[messages,setMessages]=(0,react.useState)((()=>{try{const savedMessages=localStorage.getItem("MESSAGES_KEY");if(savedMessages){const parsedMessages=JSON.parse(savedMessages);if(parsedMessages.length>0)return parsedMessages}}catch(error){console.error("Error load from localStorage key MESSAGES_KEY:",error)}return[]}));(0,react.useEffect)((()=>{try{const valueToStore=JSON.stringify(messages);localStorage.setItem("MESSAGES_KEY",valueToStore)}catch(error){console.error("Error saving to localStorage key MESSAGES_KEY:",error)}}),[messages]);const scrollToBottom=()=>{chatHistoryEnd.current&&chatHistoryEnd.current.scrollIntoView({behavior:"auto",block:"center"})};(0,react.useEffect)((()=>{scrollToBottom()}),[]),(0,react.useEffect)((()=>{scrollToBottom()}),[messages]);const handleDialogClose=()=>{setOpenDialog(!1)},handleSubmit=async e=>{if(e.preventDefault(),!loading){const inputText=textareaValue;if(setTextareaValue(""),!inputText.trim())return;abortControllerRef.current=new AbortController,setLoading(!0),setError("");const messagesWithInput=[...messages,{parts:[{text:inputText}],role:ChatHistoryInterfaces.S.USER}];setMessages(messagesWithInput);try{var _abortControllerRef$c;const model=googleGenerativeAI.getGenerativeModel({model:"gemini-1.5-flash"}),result=await model.generateContentStream({contents:messagesWithInput},{signal:null===(_abortControllerRef$c=abortControllerRef.current)||void 0===_abortControllerRef$c?void 0:_abortControllerRef$c.signal});setMessages((p=>[...p,{parts:[{text:""}],role:ChatHistoryInterfaces.S.MODEL}]));for await(const chunk of result.stream){const chunkText=chunk.text();setMessages((previusMessages=>{const newMessages=[...previusMessages];return newMessages[newMessages.length-1].parts[0].text+=chunkText,newMessages}))}}catch(error){setError("Error: "+(error instanceof Error?error.message:"Failed to fetch")),console.error("API Error:",error)}finally{setLoading(!1),abortControllerRef.current=null}}};return(0,jsx_runtime.jsxs)(emotion_element_f0de968e_browser_esm.a,{theme,children:[(0,jsx_runtime.jsx)(CssBaseline.Ay,{}),(0,jsx_runtime.jsx)(GlobalStyles.A,{styles:{body:{overflow:"auto"}}}),(0,jsx_runtime.jsxs)(Container.A,{children:[(0,jsx_runtime.jsxs)(Container.A,{sx:{pb:19,pt:8},children:[(0,jsx_runtime.jsx)(List.A,{sx:{display:"flex",flexDirection:"column"},children:messages.map(((_ref,index)=>{let{role,parts}=_ref;return(0,jsx_runtime.jsx)(ListItem.Ay,{sx:{justifyContent:"user"===role?"flex-end":"flex-start",alignItems:"flex-start"},children:(0,jsx_runtime.jsx)(Paper.A,{sx:"user"===role?{p:1,backgroundColor:grey.A[600]}:{p:1},children:(0,jsx_runtime.jsx)(MaterialMarkdown.d,{content:parts[0].text})})},index)}))}),(0,jsx_runtime.jsx)("div",{ref:chatHistoryEnd})]}),(0,jsx_runtime.jsx)(Container.A,{sx:{position:"fixed",top:0,left:0,right:0,mt:1},children:(0,jsx_runtime.jsxs)(Box.A,{sx:{display:"flex",p:1,backgroundColor:grey.A[900],borderRadius:2,"&>:not(button:first-of-type)":{ml:2}},children:[(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setOpenDialog(!0)},startIcon:(0,jsx_runtime.jsx)(VpnKey.A,{}),variant:"contained",sx:{backgroundColor:grey.A[500],"&:hover":{backgroundColor:grey.A[600]},color:"black"},children:"API Key"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setMessages([])},startIcon:(0,jsx_runtime.jsx)(Delete.A,{}),variant:"contained",sx:{backgroundColor:grey.A[500],"&:hover":{backgroundColor:grey.A[600]},color:"black"},children:"Clear Chat"}),(0,jsx_runtime.jsx)(Dialog.A,{open:openDialog,onClose:handleDialogClose,children:(0,jsx_runtime.jsxs)(DialogContent.A,{children:[(0,jsx_runtime.jsx)(DialogTitle.A,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Gemini API Key"}),(0,jsx_runtime.jsx)(IconButton.A,{"aria-label":"close",onClick:handleDialogClose,sx:theme=>({position:"absolute",right:8,top:8,color:theme.palette.grey[500]}),children:(0,jsx_runtime.jsx)(Close.A,{})}),(0,jsx_runtime.jsxs)(Stack.A,{spacing:{xs:1,sm:2},sx:{width:{sm:"300px",md:"500px"}},children:[(0,jsx_runtime.jsx)(TextField.A,{autoComplete:"off",fullWidth:!0,type:"password",label:"Enter your key",value:apiKey,onChange:event=>setApiKey(event.target.value)}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{deleteKey()},variant:"contained",color:"error",children:"Delete Key"})]})]})})]})}),(0,jsx_runtime.jsx)(Container.A,{sx:{backgroundColor:theme.palette.background.default,position:"fixed",bottom:0,left:0,right:0},children:(0,jsx_runtime.jsx)(Box.A,{sx:{borderRadius:2,backgroundColor:grey.A[800],mb:3,transform:"translateZ(0)"},children:(0,jsx_runtime.jsx)(Box.A,{sx:{padding:2},children:(0,jsx_runtime.jsxs)("form",{onSubmit:handleSubmit,onKeyDown:e=>{e.ctrlKey&&("Enter"===e.key||e.metaKey)&&(e.preventDefault(),handleSubmit(e)),"Enter"!==e.key||e.ctrlKey||e.metaKey||e.preventDefault()},children:[(0,jsx_runtime.jsx)(ChatTextarea,{placeholder:"Enter your question",ref:textareaRef,value:textareaValue,onChange:e=>{const target=e.target;setTextareaValue(target.value),textareaRef.current&&(textareaRef.current.style.height="auto",textareaRef.current.style.height=`${target.scrollHeight}px`)},onKeyDown:e=>{"Enter"!==e.key||e.ctrlKey||e.metaKey||e.preventDefault()},disabled:loading}),(0,jsx_runtime.jsxs)(Box.A,{sx:{display:"flex",alignItems:"center",justifyContent:"right"},children:[isMobile?null:(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",sx:{color:grey.A[600],mr:4},children:"To send, press Control(Ctrl) + Enter"}),(0,jsx_runtime.jsx)(Button.A,{type:"submit",endIcon:(0,jsx_runtime.jsx)(Send.A,{}),color:"primary",variant:"contained",disabled:loading,startIcon:loading?(0,jsx_runtime.jsx)(CircularProgress.A,{size:20}):null,sx:{borderRadius:4,backgroundColor:grey.A[500],"&:hover":{backgroundColor:grey.A[600]},color:"black"},children:loading?"Processing...":"Send"})]})]})})})})]})]})};GeminiChatNewDesign.__docgenInfo={description:"",methods:[],displayName:"GeminiChatNewDesign"};const GeminiChatNewDesign_stories={title:"Pages/GeminiChatNewDesign",component:GeminiChatNewDesign,parameters:{layout:"fullscreen"}},Default={args:{}},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {}\n}",...Default.parameters?.docs?.source}}}}}]);
//# sourceMappingURL=stories-GeminiChatNewDesign-stories.b78a2fc2.iframe.bundle.js.map